<!DOCTYPE html>
<html lang="en">
<head>
  <!-- ============================
       KTZs Quotes/Invoice - index.html
       ============================ -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="theme-color" content="#EAE6F8" />
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="icon.png" type="image/png" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <title>KTZ Quotes/Invoice</title>

  <!-- ‚úÖ Register Service Worker for Offline Support -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('service-worker.js')
          .then(reg => console.log('‚úÖ Service Worker registered:', reg.scope))
          .catch(err => console.error('‚ùå Service Worker failed:', err));
      });
    }
  </script>
</head>
<body>
  <!-- üîí Branch Password Prompt -->
  <div id="branchPrompt" class="branch-modal-overlay">
    <div class="branch-modal">
      <h2>Select Branch</h2>
      <p>Enter your branch code:</p>
      <input type="password" id="branchCodeInput" placeholder="Enter code" />
      <div class="branch-modal-buttons">
        <button onclick="validateBranchCode()">Continue</button>
        <button onclick="resetBranchSelection(true)">Cancel</button>
      </div>
      <div id="branchError" class="error-msg"></div>
    </div>
  </div>

  <!-- ‚úÖ Header -->
  <header class="app-header">
    <img src="icon.png" alt="KTZ Logo" class="logo" />
    <h1>KTZ Quotes/Invoice</h1>
  </header>

  <main>
    <!-- ‚úÖ Document Type Dropdown -->
    <section class="doc-toggle">
      <label class="toggle-label" for="docTypeSelect">
        <span class="doc-label">Document Type:</span>
        <select id="docTypeSelect" aria-label="Document Type">
          <option value="Invoice">Invoice</option>
          <option value="Quotation">Quotation</option>
          <option value="Export">Export</option>
          <option value="Import">Import</option>
        </select>
      </label>
    </section>

    <!-- ‚úÖ Client Info Inputs -->
    <section class="client-info">
      <input type="text" id="clientName" placeholder="Client Name" aria-label="Client Name" />
      <input type="date" id="invoiceDate" aria-label="Invoice Date" />
    </section>

    <!-- ‚úÖ Item Entry -->
    <section class="item-entry">
      <input type="text" id="itemName" placeholder="Item Name" aria-label="Item Name" />
      <input type="number" id="itemQty" placeholder="Quantity" min="1" aria-label="Quantity" />
      <input type="number" id="itemPrice" placeholder="Price (USD)" min="0" step="0.01" aria-label="Price" />
      <button id="addItemBtn">Add Item</button>
    </section>

    <!-- ‚úÖ SCROLLABLE TABLE FIX -->
    <section class="invoice-table">
      <div style="overflow-x: auto;">
        <table aria-label="Invoice Item Table">
          <thead>
            <tr>
              <th>Item</th>
              <th>Qty</th>
              <th>Price</th>
              <th>Total</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="itemList"></tbody>
        </table>
      </div>
    </section>

    <!-- ‚úÖ Totals Section -->
    <section class="totals">
      <p>Subtotal: <span id="subtotal">$0.00</span></p>
      <p><strong>Total: <span id="total">$0.00</span></strong></p>
      <button id="convertZWLBtn">Convert to ZWL</button>
    </section>

    <!-- ‚úÖ Actions -->
    <section class="actions">
      <button id="printBtn">Print</button>
      <button id="pdfBtn">Export to PDF</button>
      <button id="clearBtn">Clear All</button>
    </section>

    <!-- ‚úÖ Banking Details -->
    <section class="banking-info" style="margin-top: 2rem; font-size: 0.95rem;">
      <h3>Banking Details</h3>
      <p><strong>USD Account:</strong><br>Stanbic Bank ‚Äì Belmont Branch<br>9140000966400</p>
      <p><strong>ZIG Account:</strong><br>Stanbic Bank ‚Äì Belmont Branch<br>9140002769599</p>
    </section>
  </main>

  <!-- ‚úÖ Footer -->
  <footer>
    <p>&copy; 2025 KTZ Quotes/Invoice. Built for Kontrol Techniks Zimbabwe.</p>
  </footer>

  <!-- üñ®Ô∏è Hidden printable template -->
  <div id="invoicePrintArea" style="visibility: hidden; position: absolute; left: -9999px; top: 0;"></div>

  <!-- üì≤ PWA Install Banner -->
  <div id="installBanner" style="display: none; position: fixed; bottom: 20px; left: 20px; right: 20px; background: #eae6f8; border: 1px solid #ccc; padding: 16px; border-radius: 8px; z-index: 9999; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
    <div style="display: flex; justify-content: space-between; align-items: center;">
      <span style="font-family: 'Poppins', sans-serif; color: #4b2c76;">Install this app for a better experience.</span>
      <button id="installBtn" style="background: #7d52c1; color: white; border: none; padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer;">Install</button>
    </div>
  </div>

  <!-- üì¶ Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script src="script.js" defer></script>
</body>
</html>


